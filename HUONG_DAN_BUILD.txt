╔════════════════════════════════════════════════════════════════════╗
║               HƯỚNG DẪN BUILD SNAPVIDEO THÀNH FILE .EXE            ║
║                  (Tạo phần mềm không cần cài Python)               ║
╚════════════════════════════════════════════════════════════════════╝

Tài liệu này hướng dẫn cách build SnapVideo thành file .exe và tạo installer
để phân phối cho người dùng mà không cần cài Python.


📋 MỤC LỤC
═══════════════════════════════════════════════════════════════════════
1. Yêu cầu hệ thống
2. Chuẩn bị môi trường build
3. Build file .EXE (SnapVideo.exe)
4. Build Installer (SnapVideo_Setup.exe)
5. Kiểm tra và phân phối
6. Xử lý lỗi thường gặp


══════════════════════════════════════════════════════════════════════
1. YÊU CẦU HỆ THỐNG
══════════════════════════════════════════════════════════════════════

✅ Bắt buộc:
   - Windows 10/11 (hoặc Windows 7/8)
   - Python 3.7 trở lên (đã cài đặt và thêm vào PATH)
   - Kết nối Internet (để tải packages)
   - Dung lượng ổ cứng: ~500MB trống

✅ Tùy chọn (cho installer):
   - Inno Setup 6 (miễn phí)
   - Download: https://jrsoftware.org/isdl.php


══════════════════════════════════════════════════════════════════════
2. CHUẨN BỊ MÔI TRƯỜNG BUILD
══════════════════════════════════════════════════════════════════════

Bước 1: Mở Command Prompt trong thư mục SnapVideo
   - Shift + Chuột phải trong thư mục -> "Open PowerShell window here"
   - Hoặc: cd "đường\dẫn\đến\snapvideo"

Bước 2: Cài đặt dependencies cho build
   Gõ lệnh:
   
   pip install -r requirements-dev.txt
   
   Hoặc:
   
   pip install yt-dlp Pillow customtkinter pyinstaller

Bước 3: Kiểm tra PyInstaller đã cài đặt
   Gõ lệnh:
   
   pyinstaller --version
   
   Nếu hiện version thì OK!


══════════════════════════════════════════════════════════════════════
3. BUILD FILE .EXE (SnapVideo.exe)
══════════════════════════════════════════════════════════════════════

────────────────────────────────────────────────────────────────────
PHƯƠNG PHÁP 1: SỬ DỤNG SCRIPT TỰ ĐỘNG (KHUYẾN NGHỊ) ⭐
────────────────────────────────────────────────────────────────────

1. Double-click vào file: build_exe.bat

2. Script sẽ tự động:
   ✓ Kiểm tra Python
   ✓ Cài đặt PyInstaller (nếu cần)
   ✓ Cài đặt dependencies
   ✓ Xóa build cũ
   ✓ Build file .exe mới
   ✓ Copy file ra thư mục gốc

3. Đợi 2-5 phút để hoàn thành

4. Kết quả: File SnapVideo.exe sẽ xuất hiện trong thư mục

────────────────────────────────────────────────────────────────────
PHƯƠNG PHÁP 2: BUILD THỦ CÔNG
────────────────────────────────────────────────────────────────────

1. Mở Command Prompt trong thư mục SnapVideo

2. Chạy lệnh PyInstaller:
   
   pyinstaller --clean snapvideo.spec
   
   Hoặc nếu không dùng file .spec:
   
   pyinstaller --onefile --windowed --name SnapVideo snapvideo.py

3. Đợi build hoàn tất

4. File .exe sẽ nằm trong thư mục: dist\SnapVideo.exe

5. Copy file ra ngoài:
   
   copy dist\SnapVideo.exe SnapVideo.exe


────────────────────────────────────────────────────────────────────
GIẢI THÍCH CÁC THAM SỐ BUILD
────────────────────────────────────────────────────────────────────

--onefile         : Gộp mọi thứ vào 1 file .exe duy nhất
--windowed        : Không hiện cửa sổ console đen
--noconsole       : Tương tự --windowed
--name SnapVideo  : Đặt tên file output
--icon icon.ico   : Thêm icon cho file .exe (nếu có)
--clean           : Xóa cache và build lại từ đầu
--add-data        : Thêm file data (nếu cần)
snapvideo.spec    : Sử dụng file cấu hình có sẵn


══════════════════════════════════════════════════════════════════════
4. BUILD INSTALLER (SnapVideo_Setup.exe)
══════════════════════════════════════════════════════════════════════

Installer giúp người dùng cài đặt SnapVideo một cách chuyên nghiệp:
- Tạo shortcut trên Desktop và Start Menu
- Uninstaller tự động
- Kiểm tra phiên bản Windows
- Giao diện wizard đẹp mắt

────────────────────────────────────────────────────────────────────
BƯỚC 1: CÀI ĐẶT INNO SETUP
────────────────────────────────────────────────────────────────────

1. Download Inno Setup:
   https://jrsoftware.org/isdl.php

2. Chọn: "Inno Setup 6.x.x" (phiên bản mới nhất)

3. Cài đặt với các tùy chọn mặc định

4. Hoàn tất!

────────────────────────────────────────────────────────────────────
BƯỚC 2: BUILD INSTALLER
────────────────────────────────────────────────────────────────────

CÁCH 1: Tự động (Khuyến nghị) ⭐

1. Đảm bảo đã build file SnapVideo.exe (Bước 3)

2. Double-click file: build_installer.bat

3. Script sẽ tự động:
   ✓ Kiểm tra file SnapVideo.exe
   ✓ Tìm Inno Setup
   ✓ Build installer
   ✓ Lưu vào thư mục output/

4. Kết quả: output\SnapVideo_Setup_v1.0.0.exe


CÁCH 2: Thủ công

1. Mở Inno Setup Compiler

2. File -> Open -> chọn file "installer.iss"

3. Build -> Compile (hoặc nhấn F9)

4. Đợi hoàn tất

5. File setup sẽ nằm trong: output\SnapVideo_Setup_v1.0.0.exe

────────────────────────────────────────────────────────────────────
TÙY CHỈNH INSTALLER
────────────────────────────────────────────────────────────────────

Mở file "installer.iss" bằng notepad để tùy chỉnh:

- Thay đổi tên ứng dụng:
  #define MyAppName "SnapVideo"

- Thay đổi version:
  #define MyAppVersion "1.0.0"

- Thêm icon:
  SetupIconFile=icon.ico

- Thêm license:
  LicenseFile=LICENSE.txt

- Thay đổi thư mục cài đặt mặc định:
  DefaultDirName={autopf}\{#MyAppName}

- Và nhiều tùy chọn khác...


══════════════════════════════════════════════════════════════════════
5. KIỂM TRA VÀ PHÂN PHỐI
══════════════════════════════════════════════════════════════════════

────────────────────────────────────────────────────────────────────
KIỂM TRA FILE .EXE
────────────────────────────────────────────────────────────────────

✓ Double-click SnapVideo.exe để chạy
✓ Kiểm tra giao diện hiển thị đúng
✓ Thử tải 1 video ngắn từ YouTube
✓ Kiểm tra tất cả chức năng hoạt động
✓ Đóng và mở lại để đảm bảo ổn định

Lưu ý:
- File .exe khoảng 30-50MB
- Có thể chạy trên bất kỳ máy Windows nào
- KHÔNG CẦN cài Python
- Windows Defender có thể cảnh báo lần đầu (bình thường)

────────────────────────────────────────────────────────────────────
KIỂM TRA INSTALLER
────────────────────────────────────────────────────────────────────

✓ Chạy file SnapVideo_Setup_v1.0.0.exe
✓ Thử cài đặt trên máy khác (hoặc máy ảo)
✓ Kiểm tra shortcut được tạo đúng
✓ Chạy SnapVideo từ shortcut
✓ Thử Uninstall và kiểm tra xóa sạch

Lưu ý:
- File setup khoảng 35-55MB
- Hỗ trợ cả 32-bit và 64-bit Windows
- Có uninstaller tự động

────────────────────────────────────────────────────────────────────
PHÂN PHỐI
────────────────────────────────────────────────────────────────────

Sau khi build thành công, bạn có thể:

1. Chia sẻ file SnapVideo.exe trực tiếp
   - Upload lên Google Drive, Dropbox, etc.
   - Gửi qua email (nếu < 25MB)
   - Share trên mạng local

2. Chia sẻ Installer (SnapVideo_Setup.exe)
   - Chuyên nghiệp hơn
   - Dễ cài đặt và gỡ bỏ
   - Có thể upload lên website

3. Upload lên GitHub Releases
   - Tạo repository trên GitHub
   - Tạo Release mới
   - Upload file .exe hoặc installer
   - Người dùng có thể download miễn phí

4. Tạo website download
   - Tạo landing page đơn giản
   - Thêm link download
   - Hướng dẫn cài đặt


══════════════════════════════════════════════════════════════════════
6. XỬ LÝ LỖI THƯỜNG GẶP
══════════════════════════════════════════════════════════════════════

❌ LỖI: "pyinstaller is not recognized"
───────────────────────────────────────────────────────────────────
✅ Giải pháp:
   pip install pyinstaller
   Hoặc:
   python -m pip install pyinstaller


❌ LỖI: "ModuleNotFoundError: No module named 'yt_dlp'"
───────────────────────────────────────────────────────────────────
✅ Giải pháp:
   pip install -r requirements.txt
   Sau đó build lại


❌ LỖI: Build thành công nhưng .exe không chạy
───────────────────────────────────────────────────────────────────
✅ Giải pháp:
   - Thử build với --windowed thay vì --onefile
   - Kiểm tra antivirus có chặn không
   - Chạy với console mode để xem lỗi:
     pyinstaller --onefile snapvideo.py
     Bỏ --windowed để thấy error messages


❌ LỖI: File .exe quá lớn (>100MB)
───────────────────────────────────────────────────────────────────
✅ Giải pháp:
   - Thêm excludes trong file .spec
   - Dùng UPX để compress:
     pyinstaller --onefile --upx-dir=upx snapvideo.py
   - Loại bỏ các module không cần thiết


❌ LỖI: "Failed to execute script"
───────────────────────────────────────────────────────────────────
✅ Giải pháp:
   - Build lại với --clean
   - Kiểm tra file .spec có đúng không
   - Thêm hidden imports:
     --hidden-import=yt_dlp


❌ LỖI: Windows Defender chặn file .exe
───────────────────────────────────────────────────────────────────
✅ Giải pháp:
   - Bình thường với file .exe mới build
   - Click "More info" -> "Run anyway"
   - Để tin cậy: Add exception trong Windows Defender
   - Để phân phối: Sign code với certificate ($$)


❌ LỖI: Inno Setup không tìm thấy
───────────────────────────────────────────────────────────────────
✅ Giải pháp:
   - Cài đặt Inno Setup từ: https://jrsoftware.org/isdl.php
   - Kiểm tra đường dẫn trong build_installer.bat
   - Cài đặt vào thư mục mặc định


❌ LỖI: Import error khi chạy .exe
───────────────────────────────────────────────────────────────────
✅ Giải pháp:
   - Thêm module vào hiddenimports trong file .spec:
     hiddenimports=['module_name']
   - Build lại với --clean


══════════════════════════════════════════════════════════════════════
💡 MẸO VÀ TRICKS
══════════════════════════════════════════════════════════════════════

✨ Tối ưu kích thước file:
   - Dùng virtual environment để chỉ cài packages cần thiết
   - Exclude các module không dùng
   - Sử dụng UPX compression

✨ Tăng tốc độ build:
   - Giữ nguyên thư mục build/ giữa các lần build
   - Chỉ dùng --clean khi cần thiết
   - Dùng SSD thay vì HDD

✨ Debug dễ dàng:
   - Build với console mode trước (không dùng --windowed)
   - Kiểm tra mọi thứ OK rồi mới build windowed
   - Dùng try-catch để bắt lỗi trong code

✨ Thêm icon cho .exe:
   1. Tạo hoặc download file icon.ico
   2. Đặt vào thư mục SnapVideo
   3. Thêm vào lệnh build:
      pyinstaller --icon=icon.ico snapvideo.py
   4. Hoặc sửa trong file .spec:
      icon='icon.ico'

✨ Build trên máy ảo:
   - Dùng VMware hoặc VirtualBox
   - Cài Windows clean
   - Build để đảm bảo tương thích


══════════════════════════════════════════════════════════════════════
📦 QUY TRÌNH BUILD HOÀN CHỈNH (TÓM TẮT)
══════════════════════════════════════════════════════════════════════

1. Cài đặt Python 3.7+ (với PATH)

2. Clone/Download source code SnapVideo

3. Mở Command Prompt trong thư mục

4. Cài đặt dependencies:
   pip install -r requirements-dev.txt

5. Build file .exe:
   build_exe.bat
   (hoặc: pyinstaller --clean snapvideo.spec)

6. Kiểm tra file SnapVideo.exe

7. Cài đặt Inno Setup (nếu cần installer)

8. Build installer:
   build_installer.bat
   (hoặc compile file installer.iss)

9. Kiểm tra file SnapVideo_Setup_v1.0.0.exe

10. Phân phối!


══════════════════════════════════════════════════════════════════════
📞 HỖ TRỢ & LIÊN HỆ
══════════════════════════════════════════════════════════════════════

Nếu gặp vấn đề khi build:
- Đọc kỹ error message
- Google với từ khóa: "pyinstaller [error message]"
- Kiểm tra PyInstaller documentation
- Hỏi trên Stack Overflow

Tài liệu tham khảo:
- PyInstaller: https://pyinstaller.org/en/stable/
- Inno Setup: https://jrsoftware.org/ishelp/
- yt-dlp: https://github.com/yt-dlp/yt-dlp


══════════════════════════════════════════════════════════════════════

Chúc bạn build thành công! 🎉

═══════════════════════════════════════════════════════════════════════

